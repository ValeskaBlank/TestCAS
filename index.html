<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Wahlergebnisse</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
        }
        .container {
            margin: 20px auto;
            max-width: 1200px;
        }
        .section {
            margin-bottom: 40px;
        }
        .title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
        .source {
            font-size: 12px;
            color: gray;
            margin-bottom: 20px;
        }
        .source a {
            color: #007bff;
            text-decoration: none;
        }
        .source a:hover {
            text-decoration: underline;
        }
        .party-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .party-column {
            flex: 1;
            min-width: 120px;
            max-width: 200px;
            text-align: center;
        }
        .party-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            color: white;
            padding: 6px;
        }
        .FBP {
            background-color: black;
        }
        .VU {
            background-color: red;
        }
        .DPL {
            background-color: blue;
        }
        .FL {
            background-color: lightgray;
        }
        .candidate-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }
        .candidate-card {
            width: 100px;
            background: white;
            padding: 6px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .candidate-card img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }
        .name {
            font-size: 10px;
            font-weight: bold;
            margin-top: 5px;
        }
        .votes {
            font-size: 9px;
            font-weight: bold;
            color: #007bff;
            margin-top: 5px;
        }
        @media (max-width: 768px) {
            .title {
                font-size: 18px;
            }
            .party-title {
                font-size: 12px;
                padding: 4px;
            }
            .party-column {
                min-width: 100px;
                max-width: 150px;
            }
            .candidate-card {
                width: 90px;
                padding: 5px;
            }
            .candidate-card img {
                width: 45px;
                height: 45px;
            }
            .name {
                font-size: 9px;
            }
            .votes {
                font-size: 8px;
            }
        }
    </style>
</head>
<body>
    <h1>Landtagswahlen, 9. Februar 2025</h1>
    <div class="source">
        Quelle: <a href="https://www.landtagswahlen.li" target="_blank">www.landtagswahlen.li</a>
    </div>
    <div class="container" id="content">
        <p>Lade Wahlergebnisse...</p>
    </div>

    <script>
        async function fetchData() {
            const xmlURL = "https://www.landtagswahlen.li/resultfeed/2025";
            try {
                const response = await fetch(xmlURL);
                if (!response.ok) {
                    throw new Error(`Fehler beim Abrufen der XML-Daten: ${response.status}`);
                }
                const xmlText = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, "application/xml");

                const kandidaten = { Oberland: [], Unterland: [] };
                const addedCandidates = { Oberland: new Set(), Unterland: new Set() };

                Array.from(xmlDoc.getElementsByTagName("wahl")).forEach(wahl => {
                    const wahlbezirk = wahl.getAttribute("wahlbezirk");
                    if (wahlbezirk === "Oberland" || wahlbezirk === "Unterland") {
                        Array.from(wahl.getElementsByTagName("kandidat")).forEach(kandidat => {
                            const vorname = kandidat.getElementsByTagName("vorname")[0]?.textContent || "Unbekannt";
                            const nachname = kandidat.getElementsByTagName("nachname")[0]?.textContent || "Unbekannt";
                            const partei = kandidat.getElementsByTagName("partei")[0]?.textContent?.toUpperCase() || "UNBEKANNT";
                            const stimmenanzahl = parseInt(kandidat.getElementsByTagName("stimmenanzahl")[0]?.textContent || "0", 10);
                            const portrait = kandidat.getElementsByTagName("portraitbild")[0]?.textContent || 'https://via.placeholder.com/60';

                            const key = `${vorname} ${nachname}`;
                            if (!addedCandidates[wahlbezirk].has(key)) {
                                kandidaten[wahlbezirk].push({ vorname, nachname, partei, stimmenanzahl, portrait });
                                addedCandidates[wahlbezirk].add(key);
                            }
                        });
                    }
                });

                document.getElementById("content").innerHTML = "Wahlergebnisse geladen.";
            } catch (error) {
                console.error("Fehler beim Laden der Daten:", error);
                document.getElementById("content").innerHTML = "<p>Fehler beim Laden der Daten. Bitte sp√§ter versuchen.</p>";
            }
        }
        setInterval(fetchData, 30000);
        window.onload = fetchData;
    </script>
</body>
</html>
